IPv4 CIDR
172.31.32.0/20

$ sudo apt-get install iptables 					- update/install iptables
$ sudo iptables -L						            - show all iptables
$ sudo iptables -F				                - clear all the currently configured rules

#Task 1
25 port TCP of mail server should accept connections from internet:
$ sudo iptables -A INPUT -p tcp --dport 25 -s 0.0.0.0/0 -j ACCEPT

#Task 2
53 port TCP\UDP should be open for outbound connections for DNS use:
$ sudo iptables -A OUTPUT -p tcp --dport 53 -j ACCEPT
$ sudo iptables -A OUTPUT -p udp --dport 53 -j ACCEPT

#Task 3
143 TCP port of mail server must be closed for any connection:
$ sudo iptables -A INPUT -p tcp --dport 143 -j DROP

#Task 4
993 TCP port should be opened for HR department and Backup server connection:
$ sudo iptables -A INPUT -p tcp --dport 993 -m iprange --src-range 172.31.32.150-172.31.32.199 -j ACCEPT
$ sudo iptables -A INPUT -p tcp --dport 993 -s 172.31.32.250 -j ACCEPT

#Task 5
465 TCP port could be accessed by IT department only
$ sudo iptables -A INPUT -p tcp --dport 465 -m iprange --src-range 172.31.32.200-172.31.32.220 -j ACCEPT

#Task 6
587 TCP port must be opened for HR and IT departments only
$ sudo iptables -A INPUT -p tcp --dport 587 -m iprange --src-range 172.31.32.150-172.31.32.199 -j ACCEPT
$ sudo iptables -A INPUT -p tcp --dport 587 -m iprange --src-range 172.31.32.200-172.31.32.220 -j ACCEPT

#Task 7
Each evening Backup server used SMB default port to get mail backups from Mail server
$ sudo iptables -A INPUT -p tcp --dport 445 -s 172.31.32.250 -j ACCEPT

#Task 8
SSH default port of Mail server should be available for IT department.
$ sudo iptables -A INPUT -p tcp --dport 22 -m iprange --src-range 172.31.32.200-172.31.32.220 -j ACCEPT

#Task 9
all other ports, except 443, should be restricted
$ sudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT
$ sudo iptables -A INPUT -j DROP
